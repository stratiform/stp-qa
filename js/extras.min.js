/*! STP-web-map 08-06-2018 */

var countLines=function(t){return document.getElementById(t).offsetHeight/parseInt(document.getElementById(t).style.lineHeight)},truncate=function(t,e){return t.length>e+1?t.substring(0,e)+"...":t};!function(t){"use strict";function e(){console.log.apply(console,arguments)}function i(t,e){var i,n,o,a;for(this.list=t,this.options=e=e||{},i=0,n=(a=["sort","shouldSort","verbose","tokenize"]).length;n>i;i++)o=a[i],this.options[o]=o in e?e[o]:s[o];for(i=0,n=(a=["searchFn","sortFn","keys","getFn","include","tokenSeparator"]).length;n>i;i++)o=a[i],this.options[o]=e[o]||s[o]}function n(t){return"[object Array]"===Object.prototype.toString.call(t)}function o(t,e){e=e||{},this.options=e,this.options.location=e.location||o.defaultOptions.location,this.options.distance="distance"in e?e.distance:o.defaultOptions.distance,this.options.threshold="threshold"in e?e.threshold:o.defaultOptions.threshold,this.options.maxPatternLength=e.maxPatternLength||o.defaultOptions.maxPatternLength,this.pattern=e.caseSensitive?t:t.toLowerCase(),this.patternLen=t.length,this.patternLen<=this.options.maxPatternLength&&(this.matchmask=1<<this.patternLen-1,this.patternAlphabet=this._calculatePatternAlphabet())}var s={id:null,caseSensitive:!1,include:[],shouldSort:!0,searchFn:o,sortFn:function(t,e){return t.score-e.score},getFn:function t(e,i,o){var s,a,r,h,l,c;if(i){if(-1!==(r=i.indexOf("."))?(s=i.slice(0,r),a=i.slice(r+1)):s=i,null!==(h=e[s])&&void 0!==h)if(a||"string"!=typeof h&&"number"!=typeof h)if(n(h))for(l=0,c=h.length;c>l;l++)t(h[l],a,o);else a&&t(h,a,o);else o.push(h)}else o.push(e);return o},keys:[],verbose:!1,tokenize:!1,matchAllTokens:!1,tokenSeparator:/ +/g};i.VERSION="2.5.0",i.prototype.set=function(t){return this.list=t,t},i.prototype.search=function(t){return this.options.verbose&&e("\nSearch term:",t,"\n"),this.pattern=t,this.results=[],this.resultMap={},this._keyMap=null,this._prepareSearchers(),this._startSearch(),this._computeScore(),this._sort(),this._format()},i.prototype._prepareSearchers=function(){var t=this.options,e=this.pattern,i=t.searchFn,n=e.split(t.tokenSeparator),o=0,s=n.length;if(this.options.tokenize)for(this.tokenSearchers=[];s>o;o++)this.tokenSearchers.push(new i(n[o],t));this.fullSeacher=new i(e,t)},i.prototype._startSearch=function(){var t,e,i,n,o=this.options.getFn,s=this.list,a=s.length,r=this.options.keys,h=r.length,l=null;if("string"==typeof s[0])for(i=0;a>i;i++)this._analyze("",s[i],i,i);else for(this._keyMap={},i=0;a>i;i++)for(l=s[i],n=0;h>n;n++){if("string"!=typeof(t=r[n])){if(e=1-t.weight||1,this._keyMap[t.name]={weight:e},t.weight<=0||t.weight>1)throw new Error("Key weight has to be > 0 and <= 1");t=t.name}else this._keyMap[t]={weight:1};this._analyze(t,o(l,t,[]),l,i)}},i.prototype._analyze=function(t,i,o,s){var a,r,h,l,c,p,u,f,d,m,_,v,b,L,g,y=this.options,k=!1;if(void 0!==i&&null!==i){r=[];var w=0;if("string"==typeof i){if(a=i.split(y.tokenSeparator),y.verbose&&e("---------\nKey:",t),this.options.tokenize){for(L=0;L<this.tokenSearchers.length;L++){for(f=this.tokenSearchers[L],y.verbose&&e("Pattern:",f.pattern),d=[],v=!1,g=0;g<a.length;g++){m=a[g];var M={};(_=f.search(m)).isMatch?(M[m]=_.score,k=!0,v=!0,r.push(_.score)):(M[m]=1,this.options.matchAllTokens||r.push(1)),d.push(M)}v&&w++,y.verbose&&e("Token scores:",d)}for(l=r[0],p=r.length,L=1;p>L;L++)l+=r[L];l/=p,y.verbose&&e("Token score average:",l)}u=this.fullSeacher.search(i),y.verbose&&e("Full text score:",u.score),c=u.score,void 0!==l&&(c=(c+l)/2),y.verbose&&e("Score average:",c),b=!this.options.tokenize||!this.options.matchAllTokens||w>=this.tokenSearchers.length,y.verbose&&e("Check Matches",b),(k||u.isMatch)&&b&&((h=this.resultMap[s])?h.output.push({key:t,score:c,matchedIndices:u.matchedIndices}):(this.resultMap[s]={item:o,output:[{key:t,score:c,matchedIndices:u.matchedIndices}]},this.results.push(this.resultMap[s])))}else if(n(i))for(L=0;L<i.length;L++)this._analyze(t,i[L],o,s)}},i.prototype._computeScore=function(){var t,i,n,o,s,a,r,h,l=this._keyMap,c=this.results;for(this.options.verbose&&e("\n\nComputing score:\n"),t=0;t<c.length;t++){for(n=0,s=(o=c[t].output).length,r=1,i=0;s>i;i++)h=o[i].score*(a=l?l[o[i].key].weight:1),1!==a?r=Math.min(r,h):(n+=h,o[i].nScore=h);c[t].score=1===r?n/s:r,this.options.verbose&&e(c[t])}},i.prototype._sort=function(){var t=this.options;t.shouldSort&&(t.verbose&&e("\n\nSorting...."),this.results.sort(t.sortFn))},i.prototype._format=function(){var t,i,n,o,s,a=this.options,r=a.getFn,h=[],l=this.results,c=a.include;for(a.verbose&&e("\n\nOutput:\n\n",l),o=a.id?function(t){l[t].item=r(l[t].item,a.id,[])[0]}:function(){},s=function(t){var e,i,n,o,s,a=l[t];if(c.length>0){if(e={item:a.item},-1!==c.indexOf("matches"))for(n=a.output,e.matches=[],i=0;i<n.length;i++)s={indices:(o=n[i]).matchedIndices},o.key&&(s.key=o.key),e.matches.push(s);-1!==c.indexOf("score")&&(e.score=l[t].score)}else e=a.item;return e},i=0,n=l.length;n>i;i++)o(i),t=s(i),h.push(t);return h},o.defaultOptions={location:0,distance:100,threshold:.6,maxPatternLength:32},o.prototype._calculatePatternAlphabet=function(){var t={},e=0;for(e=0;e<this.patternLen;e++)t[this.pattern.charAt(e)]=0;for(e=0;e<this.patternLen;e++)t[this.pattern.charAt(e)]|=1<<this.pattern.length-e-1;return t},o.prototype._bitapScore=function(t,e){var i=t/this.patternLen,n=Math.abs(this.options.location-e);return this.options.distance?i+n/this.options.distance:n?1:i},o.prototype.search=function(t){var e,i,n,o,s,a,r,h,l,c,p,u,f,d,m,_,v,b,L,g,y,k,w=this.options;if(t=w.caseSensitive?t:t.toLowerCase(),this.pattern===t)return{isMatch:!0,score:0,matchedIndices:[[0,t.length-1]]};if(this.patternLen>w.maxPatternLength){if(b=!!(v=t.match(new RegExp(this.pattern.replace(w.tokenSeparator,"|")))))for(g=[],e=0,y=v.length;y>e;e++)k=v[e],g.push([t.indexOf(k),k.length-1]);return{isMatch:b,score:b?.5:1,matchedIndices:g}}for(o=w.location,n=t.length,s=w.threshold,a=t.indexOf(this.pattern,o),L=[],e=0;n>e;e++)L[e]=0;for(-1!=a&&(s=Math.min(this._bitapScore(0,a),s),-1!=(a=t.lastIndexOf(this.pattern,o+this.patternLen))&&(s=Math.min(this._bitapScore(0,a),s))),a=-1,m=1,_=[],l=this.patternLen+n,e=0;e<this.patternLen;e++){for(r=0,h=l;h>r;)this._bitapScore(e,o+h)<=s?r=h:l=h,h=Math.floor((l-r)/2+r);for(l=h,c=Math.max(1,o-h+1),p=Math.min(o+h,n)+this.patternLen,(u=Array(p+2))[p+1]=(1<<e)-1,i=p;i>=c;i--)if((d=this.patternAlphabet[t.charAt(i-1)])&&(L[i-1]=1),u[i]=0===e?(u[i+1]<<1|1)&d:(u[i+1]<<1|1)&d|(f[i+1]|f[i])<<1|1|f[i+1],u[i]&this.matchmask&&s>=(m=this._bitapScore(e,i-1))){if(s=m,a=i-1,_.push(a),!(a>o))break;c=Math.max(1,2*o-a)}if(this._bitapScore(e+1,o)>s)break;f=u}return g=this._getMatchedIndices(L),{isMatch:a>=0,score:0===m?.001:m,matchedIndices:g}},o.prototype._getMatchedIndices=function(t){for(var e,i=[],n=-1,o=-1,s=0,a=t.length;a>s;s++)(e=t[s])&&-1===n?n=s:e||-1===n||(o=s-1,i.push([n,o]),n=-1);return t[s-1]&&i.push([n,s-1]),i},"object"==typeof exports?module.exports=i:"function"==typeof define&&define.amd?define(function(){return i}):t.Fuse=i}(this),function(t){t.fn.getSVG=function(e){var i=this[0].contentDocument;return t(i)},t.fn.setSVGStyle=function(t){var e=this[0].contentDocument,i=e.createElementNS("http://www.w3.org/2000/svg","style");i.textContent=t,e.getElementsByTagName("svg")[0].appendChild(i)},t.fn.setSVGStyleLink=function(t){var e=this[0].contentDocument,i=e.createElementNS("http://www.w3.org/1999/xhtml","link");i.setAttribute("href",t),i.setAttribute("type","text/css"),i.setAttribute("rel","stylesheet"),e.getElementsByTagName("svg")[0].appendChild(i)},t.getRandom=function(t,e){return Math.floor(Math.random()*(e-t+1))+t}}(jQuery),Array.prototype.map||(Array.prototype.map=function(t){var e=this.length;if("function"!=typeof t)throw new TypeError;for(var i=new Array(e),n=arguments[1],o=0;o<e;o++)o in this&&(i[o]=t.call(n,this[o],o,this));return i}),L.Control.FuseSearch=L.Control.extend({includes:L.Mixin.Events,options:{position:"topright",title:"Search",panelTitle:"",placeholder:"Search",caseSensitive:!1,threshold:.5,maxResultLength:null,showResultFct:null,showInvisibleFeatures:!0,mapObj:null},initialize:function(t){L.setOptions(this,t),this._panelOnLeftSide=-1!==this.options.position.indexOf("left")},onAdd:function(t){var e=this._createControl();return this._createPanel(t),this._setEventListeners(),t.invalidateSize(),e},onRemove:function(t){return this.hidePanel(t),this._clearEventListeners(),this._clearPanel(t),this._clearControl(),this},_createControl:function(){var t=L.DomUtil.create("div","leaflet-fusesearch-control"),e=this._openButton=L.DomUtil.create("a","button",t);e.href="#",e.title=this.options.title;var i=L.DomEvent.stopPropagation;return L.DomEvent.on(e,"click",i).on(e,"mousedown",i).on(e,"touchstart",i).on(e,"mousewheel",i).on(e,"MozMousePixelScroll",i),L.DomEvent.on(e,"click",L.DomEvent.preventDefault),L.DomEvent.on(e,"click",this.showPanel,this),t},_clearControl:function(){var t=this._openButton,e=L.DomEvent.stopPropagation;L.DomEvent.off(t,"click",e).off(t,"mousedown",e).off(t,"touchstart",e).off(t,"mousewheel",e).off(t,"MozMousePixelScroll",e),L.DomEvent.off(t,"click",L.DomEvent.preventDefault),L.DomEvent.off(t,"click",this.showPanel)},_createPanel:function(t){var e=this,i=t.getContainer(),n=this._panel=L.DomUtil.create("div","leaflet-fusesearch-panel",i),o=L.DomEvent.stopPropagation;L.DomEvent.on(n,"click",o).on(n,"dblclick",o).on(n,"mousedown",o).on(n,"touchstart",o).on(n,"mousewheel",o).on(n,"MozMousePixelScroll",o),this._panelOnLeftSide?L.DomUtil.addClass(n,"left"):L.DomUtil.addClass(n,"right");var s=L.DomUtil.create("div","content",n),a=L.DomUtil.create("div","header",s);this.options.panelTitle&&(L.DomUtil.create("h2","panel-title",a).innerHTML=this.options.panelTitle);L.DomUtil.create("img","search-image",a).src="img/ic_search_black_24dp_1x.png",this._input=L.DomUtil.create("input","search-input",a),this._input.maxLength=30,this._input.placeholder=this.options.placeholder,this._input.onkeyup=function(t){var i=t.currentTarget.value;e.searchFeatures(i)};var r=this._closeButton=L.DomUtil.create("a","close",a);return r.innerHTML="&times;",L.DomEvent.on(r,"click",this.hidePanel,this),this._resultList=L.DomUtil.create("div","result-list",s),n},_clearPanel:function(t){var e=L.DomEvent.stopPropagation;L.DomEvent.off(this._panel,"click",e).off(this._panel,"dblclick",e).off(this._panel,"mousedown",e).off(this._panel,"touchstart",e).off(this._panel,"mousewheel",e).off(this._panel,"MozMousePixelScroll",e),L.DomEvent.off(this._closeButton,"click",this.hidePanel),t.getContainer().removeChild(this._panel),this._panel=null},_setEventListeners:function(){var t=this,e=this._input;this._map.addEventListener("overlayadd",function(){t.searchFeatures(e.value)}),this._map.addEventListener("overlayremove",function(){t.searchFeatures(e.value)})},_clearEventListeners:function(){this._map.removeEventListener("overlayadd"),this._map.removeEventListener("overlayremove")},isPanelVisible:function(){return L.DomUtil.hasClass(this._panel,"visible")},showPanel:function(){this.isPanelVisible()||(L.DomUtil.addClass(this._panel,"visible"),this.fire("show"),this._input.select(),this.searchFeatures(this._input.value))},hidePanel:function(t){this.isPanelVisible()&&(L.DomUtil.removeClass(this._panel,"visible"),this._map,this.fire("hide"),t&&L.DomEvent.stopPropagation(t))},getOffset:function(){return this._panelOnLeftSide?-this._panel.offsetWidth:this._panel.offsetWidth},indexFeatures:function(t,e){var i=t.features||t;this._keys=e;var n=i.map(function(t){return t.properties._feature=t,t.properties}),o={keys:e,caseSensitive:this.options.caseSensitive,threshold:this.options.threshold};this._fuseIndex=new Fuse(n,o)},searchFeatures:function(t){for(var e=this._fuseIndex.search(t),i=document.querySelectorAll(".result-item"),n=0;n<i.length;n++)i[n].remove();var o=document.querySelector(".result-list"),s=0,a=this.options.maxResultLength;for(var n in e){var r=e[n],h=r._feature,l=this._getFeaturePopupIfVisible(h);if((void 0!==l||this.options.showInvisibleFeatures)&&(this.createResultItem(r,o,l),void 0!==a&&++s===a))break}},refresh:function(){this.isPanelVisible()&&this.searchFeatures(this._input.value)},_getFeaturePopupIfVisible:function(t){var e=t.layer;if(void 0!==e&&this._map.hasLayer(e))return e.getPopup()},createResultItem:function(t,e,i){var n=this,o=t._feature,s=L.DomUtil.create("p","result-item",e);if(void 0!==i?(L.DomUtil.addClass(s,"clickable"),s.onclick=function(){window.matchMedia("(max-width:480px)").matches?(n.hidePanel(),o.layer.openPopup()):n._panAndPopup(o,i)}):(L.DomUtil.addClass(s,"clickable"),s.onclick=function(){window.matchMedia("(max-width:480px)").matches?(n.hidePanel(),o.layer.openPopup()):n._panAndPopup(o,null)}),null!==this.options.showResultFct)this.options.showResultFct(o,s);else{str="<b>"+t[this._keys[0]]+"</b>";for(var a=1;a<this._keys.length;a++)str+="<br/>"+t[this._keys[a]];s.innerHTML=str}return s},_panAndPopup:function(t,e){if(this._panelOnLeftSide){this.options.mapObj.panTo([t.geometry.coordinates[1],t.geometry.coordinates[0]]);var i=new L.Popup({offset:L.point(0,-3)}).setLatLng([t.geometry.coordinates[1],t.geometry.coordinates[0]]).setContent(t.properties.hospital_name).addTo(this.options.mapObj);this.options.mapObj.openPopup(i)}else{this.options.mapObj.panTo([t.geometry.coordinates[1],t.geometry.coordinates[0]]);i=new L.Popup({offset:L.point(0,-3)}).setLatLng([t.geometry.coordinates[1],t.geometry.coordinates[0]]).setContent(t.properties.hospital_name).addTo(this.options.mapObj);this.options.mapObj.openPopup(i)}}}),L.control.fuseSearch=function(t){return new L.Control.FuseSearch(t)},function(t,e){"function"==typeof define&&define.amd?define(["leaflet"],t):"object"==typeof exports&&(module.exports=t(require("leaflet"))),void 0!==e&&e.L&&(e.LeafletLabel=t(L))}(function(t){t.labelVersion="0.2.4";var e=(t.Layer?t.Layer:t.Class).extend({includes:t.Mixin.Events,options:{className:"",clickable:!1,direction:"right",noHide:!1,offset:[12,-15],opacity:1,zoomAnimation:!0},initialize:function(e,i){t.setOptions(this,e),this._source=i,this._animated=t.Browser.any3d&&this.options.zoomAnimation,this._isOpen=!1},onAdd:function(e){this._map=e,this._pane=this.options.pane?e._panes[this.options.pane]:this._source instanceof t.Marker?e._panes.markerPane:e._panes.popupPane,this._container||this._initLayout(),this._pane.appendChild(this._container),this._initInteraction(),this._update(),this.setOpacity(this.options.opacity),e.on("moveend",this._onMoveEnd,this).on("viewreset",this._onViewReset,this),this._animated&&e.on("zoomanim",this._zoomAnimation,this),t.Browser.touch&&!this.options.noHide&&(t.DomEvent.on(this._container,"click",this.close,this),e.on("click",this.close,this))},onRemove:function(t){this._pane.removeChild(this._container),t.off({zoomanim:this._zoomAnimation,moveend:this._onMoveEnd,viewreset:this._onViewReset},this),this._removeInteraction(),this._map=null},setLatLng:function(e){return this._latlng=t.latLng(e),this._map&&this._updatePosition(),this},setContent:function(t){return this._previousContent=this._content,this._content=t,this._updateContent(),this},close:function(){var e=this._map;e&&(t.Browser.touch&&!this.options.noHide&&(t.DomEvent.off(this._container,"click",this.close),e.off("click",this.close,this)),e.removeLayer(this))},updateZIndex:function(t){this._zIndex=t,this._container&&this._zIndex&&(this._container.style.zIndex=t)},setOpacity:function(e){this.options.opacity=e,this._container&&t.DomUtil.setOpacity(this._container,e)},_initLayout:function(){this._container=t.DomUtil.create("div","leaflet-label "+this.options.className+" leaflet-zoom-animated"),this.updateZIndex(this._zIndex)},_update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updatePosition(),this._container.style.visibility="")},_updateContent:function(){this._content&&this._map&&this._prevContent!==this._content&&"string"==typeof this._content&&(this._container.innerHTML=this._content,this._prevContent=this._content,this._labelWidth=this._container.offsetWidth)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},_setPosition:function(e){var i=this._map,n=this._container,o=i.latLngToContainerPoint(i.getCenter()),s=i.layerPointToContainerPoint(e),a=this.options.direction,r=this._labelWidth,h=t.point(this.options.offset);"right"===a||"auto"===a&&s.x<o.x?(t.DomUtil.addClass(n,"leaflet-label-right"),t.DomUtil.removeClass(n,"leaflet-label-left"),e=e.add(h)):(t.DomUtil.addClass(n,"leaflet-label-left"),t.DomUtil.removeClass(n,"leaflet-label-right"),e=e.add(t.point(-h.x-r,h.y))),t.DomUtil.setPosition(n,e)},_zoomAnimation:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPosition(e)},_onMoveEnd:function(){this._animated&&"auto"!==this.options.direction||this._updatePosition()},_onViewReset:function(t){t&&t.hard&&this._update()},_initInteraction:function(){if(this.options.clickable){var e=this._container,i=["dblclick","mousedown","mouseover","mouseout","contextmenu"];t.DomUtil.addClass(e,"leaflet-clickable"),t.DomEvent.on(e,"click",this._onMouseClick,this);for(var n=0;i.length>n;n++)t.DomEvent.on(e,i[n],this._fireMouseEvent,this)}},_removeInteraction:function(){if(this.options.clickable){var e=this._container,i=["dblclick","mousedown","mouseover","mouseout","contextmenu"];t.DomUtil.removeClass(e,"leaflet-clickable"),t.DomEvent.off(e,"click",this._onMouseClick,this);for(var n=0;i.length>n;n++)t.DomEvent.off(e,i[n],this._fireMouseEvent,this)}},_onMouseClick:function(e){this.hasEventListeners(e.type)&&t.DomEvent.stopPropagation(e),this.fire(e.type,{originalEvent:e})},_fireMouseEvent:function(e){this.fire(e.type,{originalEvent:e}),"contextmenu"===e.type&&this.hasEventListeners(e.type)&&t.DomEvent.preventDefault(e),"mousedown"!==e.type?t.DomEvent.stopPropagation(e):t.DomEvent.preventDefault(e)}});return t.BaseMarkerMethods={showLabel:function(){return this.label&&this._map&&(this.label.setLatLng(this._latlng),this._map.showLabel(this.label)),this},hideLabel:function(){return this.label&&this.label.close(),this},setLabelNoHide:function(t){this._labelNoHide!==t&&(this._labelNoHide=t,t?(this._removeLabelRevealHandlers(),this.showLabel()):(this._addLabelRevealHandlers(),this.hideLabel()))},bindLabel:function(i,n){var o=this.options.icon?this.options.icon.options.labelAnchor:this.options.labelAnchor,s=t.point(o)||t.point(0,0);return s=s.add(e.prototype.options.offset),n&&n.offset&&(s=s.add(n.offset)),n=t.Util.extend({offset:s},n),this._labelNoHide=n.noHide,this.label||(this._labelNoHide||this._addLabelRevealHandlers(),this.on("remove",this.hideLabel,this).on("move",this._moveLabel,this).on("add",this._onMarkerAdd,this),this._hasLabelHandlers=!0),this.label=new e(n,this).setContent(i),this},unbindLabel:function(){return this.label&&(this.hideLabel(),this.label=null,this._hasLabelHandlers&&(this._labelNoHide||this._removeLabelRevealHandlers(),this.off("remove",this.hideLabel,this).off("move",this._moveLabel,this).off("add",this._onMarkerAdd,this)),this._hasLabelHandlers=!1),this},updateLabelContent:function(t){this.label&&this.label.setContent(t)},getLabel:function(){return this.label},_onMarkerAdd:function(){this._labelNoHide&&this.showLabel()},_addLabelRevealHandlers:function(){this.on("mouseover",this.showLabel,this).on("mouseout",this.hideLabel,this),t.Browser.touch&&this.on("click",this.showLabel,this)},_removeLabelRevealHandlers:function(){this.off("mouseover",this.showLabel,this).off("mouseout",this.hideLabel,this),t.Browser.touch&&this.off("click",this.showLabel,this)},_moveLabel:function(t){this.label.setLatLng(t.latlng)}},t.Icon.Default.mergeOptions({labelAnchor:new t.Point(9,-20)}),t.Marker.mergeOptions({icon:new t.Icon.Default}),t.Marker.include(t.BaseMarkerMethods),t.Marker.include({_originalUpdateZIndex:t.Marker.prototype._updateZIndex,_updateZIndex:function(t){var e=this._zIndex+t;this._originalUpdateZIndex(t),this.label&&this.label.updateZIndex(e)},_originalSetOpacity:t.Marker.prototype.setOpacity,setOpacity:function(t,e){this.options.labelHasSemiTransparency=e,this._originalSetOpacity(t)},_originalUpdateOpacity:t.Marker.prototype._updateOpacity,_updateOpacity:function(){var t=0===this.options.opacity?0:1;this._originalUpdateOpacity(),this.label&&this.label.setOpacity(this.options.labelHasSemiTransparency?this.options.opacity:t)},_originalSetLatLng:t.Marker.prototype.setLatLng,setLatLng:function(t){return this.label&&!this._labelNoHide&&this.hideLabel(),this._originalSetLatLng(t)}}),t.CircleMarker.mergeOptions({labelAnchor:new t.Point(0,0)}),t.CircleMarker.include(t.BaseMarkerMethods),t.Path.include({bindLabel:function(i,n){return this.label&&this.label.options===n||(this.label=new e(n,this)),this.label.setContent(i),this._showLabelAdded||(this.on("mouseover",this._showLabel,this).on("mousemove",this._moveLabel,this).on("mouseout remove",this._hideLabel,this),t.Browser.touch&&this.on("click",this._showLabel,this),this._showLabelAdded=!0),this},unbindLabel:function(){return this.label&&(this._hideLabel(),this.label=null,this._showLabelAdded=!1,this.off("mouseover",this._showLabel,this).off("mousemove",this._moveLabel,this).off("mouseout remove",this._hideLabel,this)),this},updateLabelContent:function(t){this.label&&this.label.setContent(t)},_showLabel:function(t){this.label.setLatLng(t.latlng),this._map.showLabel(this.label)},_moveLabel:function(t){this.label.setLatLng(t.latlng)},_hideLabel:function(){this.label.close()}}),t.Map.include({showLabel:function(t){return this.addLayer(t)}}),t.FeatureGroup.include({clearLayers:function(){return this.unbindLabel(),this.eachLayer(this.removeLayer,this),this},bindLabel:function(t,e){return this.invoke("bindLabel",t,e)},unbindLabel:function(){return this.invoke("unbindLabel")},updateLabelContent:function(t){this.invoke("updateLabelContent",t)}}),e},window);